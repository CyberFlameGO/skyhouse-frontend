<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Loading...</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Encode+Sans+SC:wght@200&display=swap');

        @keyframes spin3D {
            from {
                transform: rotate3d(.5,.5,.5, 360deg);
            }
            to{
                transform: rotate3d(0deg);
            }
        }

        * {
            box-sizing: border-box;
        }

        body {
            min-height: 100vh;
            background-color: #1d2630;
            display: flex;
            justify-content: space-between;
            flex-wrap: wrap;
            align-items: flex-start;
        }

        .spinner-box {
            width: 300px;
            height: 300px;
            display: flex;
            justify-content: center;
            align-items: center;
            background-color: transparent;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }

        .leo-border-1 {
            position: absolute;
            width: 150px;
            height: 150px;
            padding: 3px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50%;
            background: rgb(63,249,220);
            background: linear-gradient(0deg, rgba(63,249,220,0.1) 33%, rgba(63,249,220,1) 100%);
            animation: spin3D 1.8s linear 0s infinite;
        }

        .leo-core-1 {
            width: 100%;
            height: 100%;
            background-color: #37474faa;
            border-radius: 50%;
        }

        .leo-border-2 {
            position: absolute;
            width: 150px;
            height: 150px;
            padding: 3px;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 50%;
            background: rgb(251, 91, 83);
            background: linear-gradient(0deg, rgba(251, 91, 83, 0.1) 33%, rgba(251, 91, 83, 1) 100%);
            animation: spin3D 2.2s linear 0s infinite;
        }

        .leo-core-2 {
            width: 100%;
            height: 100%;
            background-color: #1d2630aa;
            border-radius: 50%;
        }

        .auth-text {
            color: rgba(255,255,255,0.3);
            z-index: 999;
            font-family: 'Encode Sans SC', sans-serif;
        }
    </style>
</head>
<body>
<div class="spinner-box">
    <h2 class="auth-text"></h2>
    <div class="leo-border-1">
        <div class="leo-core-1"></div>
    </div>
    <div class="leo-border-2">
        <div class="leo-core-2"></div>
    </div>
</div>
<script>
    const query = new URLSearchParams(window.location.search);
    const code = query.get('code');
    httpGetAsync(`https://api.skyblock.tools/auth/oauth/create?code=${code}`, function(res){
        const json = res.responseText;
        window.localStorage.setItem('user_session_data', json);
        window.close();
    });

    function httpGetAsync(theUrl, callback)
    {
        if(window.location.href.includes("localhost")) {
            theUrl += "&allowLocalhostRedirectURI=yes";
        }
        var xmlHttp = new XMLHttpRequest();
        xmlHttp.onreadystatechange = function() {
            if (xmlHttp.readyState == 4 && xmlHttp.status == 200)
                callback(xmlHttp);
        }
        xmlHttp.open("GET", theUrl, true);
        xmlHttp.send(null);
    }
</script>
</body>
</html>